<app-header></app-header>

<div class="container-fluid h-100">
  <app-sidebar></app-sidebar>
    <main class="col-md-12 ms-sm-auto col-lg-11 px-md-4 h-100"> 


      <div class="row row-cols-1 row-cols-md-4 g-4 mb-5 pt-5 pb-2 mb-3">
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                    <h5>Total Context</h5>
                    <h5 class="text-danger">{{countcontext}}</h5>
            </div>
                <p></p>
            </div>
        </div>
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                    <h5>Total Question/Réponses</h5>
                    <h5 class="text-danger">{{countcontextconvertation}}</h5>
            </div>
                <p></p>
            </div>
        </div>
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                    <h5>Total User</h5>
                    <h5 class="text-danger">{{countclient}}</h5>
            </div>
                <p></p>
            </div>
        </div>
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                    <h5>Total Confirmed</h5>
                    <h5 class="text-danger">9552778</h5>
                </div>
                <p></p>
            </div>
        </div>
    </div>


     <div class="row row-cols-1 row-cols-md-2 g-4 mb-5 pt-5 pb-2 mb-3">
       <div class="col"  >





         <div class="card  shadow h-100"  >
             <div class="card-header">
                 Context
             </div>
            <div class="card-body">



              <div class="container-fluid h-50">
                <div class="row justify-content-center h-100">
                  <div class=" chat">
                    <!-- <div class="card"> -->
                      <div class="card-header msg_head">
                        <div class="d-flex bd-highlight">
                          <div class="img_cont">
                            <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img">
                            <span class="online_icon"></span>
                            <!-- <span cless="offline_icon"></span> -->
                          </div>
                          <div class="user_info">
                            <span>Chat with jassa</span>
                            <p>1767 Messages</p>
                          </div>
                          <div class="video_cam">
                            <span><i class="fas fa-video"></i></span>
                            <span><i class="fas fa-phone"></i></span>
                          </div>
                        </div>
                        <span id="action_menu_btn"><i class="fas fa-ellipsis-v"></i></span>
                        <div class="action_menu">
                          <ul>
                            <li><i class="fas fa-user-circle"></i> View profile</li>
                            <li><i class="fas fa-users"></i> Add to close friends</li>
                            <li><i class="fas fa-plus"></i> Add to group</li>
                            <li><i class="fas fa-ban"></i> Block</li>
                          </ul>
                        </div>
                      </div>
                      <div class="card-body msg_card_body">
                        <!-- <div *ngfor="let message of visiteur_convertationlist">

                        <div class="d-flex justify-content-start mb-4">
                          <div class="img_cont_msg">
                            <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                          </div>
                          <div class="msg_cotainer">
                            {{message.question}}
                            <span class="msg_time">8:40 AM, Today</span>
                          </div>
                        </div>
                        <div class="d-flex justify-content-end mb-4">
                          <div class="msg_cotainer_send">
                            {{message.response}}
                            <span class="msg_time_send">8:55 AM, Today</span>
                          </div>
                          <div class="img_cont_msg">
                        <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                          </div>
                        </div>
                      </div> -->
                      <div *ngFor="let msg of visiteur_convertationlist">
                        <div ng-If="msg.photo==null"><!--debut ng if photo is valid-->
                          <div class="d-flex justify-content-end mb-4">
                            <div class="msg_cotainer_send">
                              {{msg.question}}
                              
                              <img ng-if="msg.photo!=null" src="{{msg.photo}}" alt="{{msg.photo}}" width="200"/> 
                              <span class="msg_time_send" style="color:rgb(20, 20, 32)">{{msg.entry_date}}</span>
                            </div>
                            <div class="img_cont_msg">
                          <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                            </div>
                          </div>
                          <div class="d-flex justify-content-start mb-4">
                            <div class="img_cont_msg">
                              <img src="https://therichpost.com/wp-content/uploads/2020/06/avatar2.png" class="rounded-circle user_img_msg">
                            </div>
                            <div class="msg_cotainer">
                               {{msg.response}}
                              <span class="msg_time_send" style="color:rgb(20, 20, 32)">{{msg.entry_date}}</span>
                            </div>
                          </div>
                          </div><!--fin ng if-->
  
                         
                        </div>
                    </div>
                      <div class="card-footer">
                        <div class="input-group">
                          <div class="input-group-append">
                            <span class="input-group-text attach_btn"><i class="mdi mdi-paperclip"></i></span>
                          </div>
                          <input name="question"  [(ngModel)]="question" class="form-control type_msg" placeholder="Type your message..." (keydown.enter)="sendmsg()">
                          <div class="input-group-append">
                            <span class="input-group-text send_btn" (click)="sendmsg()"><i class="mdi mdi-send"></i></span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
         </div>
        <!-- </div> -->

        <div class="col"  >
            <div class="card  shadow h-100"  >

              <div class="card-header">
                Context charset
              </div>
              <div class="card-body">

                <canvas baseChart 
                  [datasets]="lineChartData" 
                  [labels]="lineChartLabels" 
                  [options]="lineChartOptions"
                  [colors]="lineChartColors" 
                  [legend]="lineChartLegend" 
                  [chartType]="lineChartType" 
                  [plugins]="lineChartPlugins">
              </canvas>


              </div>


              <div class="card-header">
                Context charset
              </div>
            <div class="card-body ">
              <div class="col-md-3">
                <select class="form-select" [(ngModel)]="top" name="top" (change)="selectLimit($event)">
                    <option  [value]= 3  >
                        3
                    </option>
                    <option  [value]= 5 >
                        5
                    </option>
                    <option [value]= 10  >
                        10
                    </option>
                    
                </select>
            </div>

              <canvas baseChart 
                [data]="pieChartData" 
                [labels]="pieChartLabels" 
                [chartType]="pieChartType"
                [options]="pieChartOptions"
                [colors]="pieChartColors"

              >
              </canvas>
            </div>
              

            </div>

         </div>
      </div>


      <div class="row ">
        <div class="col"  >
            <div class="card  shadow h-100"  >
                <div class="card-body">
                    <h5 >Context List</h5>
                      <div class="card-body">
                        <table id="example" class="table table-striped" >
                            <thead>
                              <tr>
                                <th scope="col">Text</th>
                                <th scope="col">Titre</th>
                                <th scope="col">Entry date</th>
                                <th scope="col">Status</th>
                                <th scope="col">Type</th>
                               
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let collumn of contextforalluserlist | paginate: { itemsPerPage: 10, currentPage: p }">
                                <td scope="row">{{collumn.text}}</td>
                                <td scope="row">{{collumn.title}}</td>
                                <td>{{collumn.entry_date}}</td>
                                
                                <td>
                                    <span  class="badge badge-success">Valide</span>
                                    <!-- <span *ngIf="context.status == '0'" class="badge badge-danger">Deleted</span>  -->

                                </td>
                                <td>
                                  <span  class="badge badge-success"><i class="mdi mdi-earth"></i></span>
                                  <!-- <span   class="badge badge-danger"><i class="mdi mdi-earth-off"></i></span>  -->
                                </td>

                                
                                <td>
                                  <span  type="button"  (click)="ModalShowQuestionAnserwerOpen(showQA);getQR(collumn.id_context)" class="badge badge-info" ><a type="button"  ><i class="mdi mdi-telescope" ></i> </a></span> 
                                  
                                </td>
                                <!-- <td><button type="button" class="btn btn-primary" (click)="modalUpdateOpen(modalUpdateContext,context.id_context,context.text)">Update</button></td> -->
                              </tr>
                            
                            </tbody>
                          </table>
                          <div class="pagination">
                            <pagination-controls (pageChange)="p = $event"></pagination-controls>
                          </div>
                    </div>
                  </div>
                  <p></p>
              </div>
          </div>
         
      </div>
    


    


       </main> 
</div>



<!-- <ng-template #showQA >
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Ajouter nouveau Question & Réponse</h4>
     <button type="button" class="close" aria-label="Close" (click)="closeDialog()" >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-body">
      <div class="card-body table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col"> Question </th>
            <th scope="col"> Answer </th>
           
          </tr>
        </thead>
        <tbody>
          <tr  *ngFor="let collumn of context_QRlist">
            <td style="overflow-wrap: break-word;" scope="row">{{collumn.question}}</td>
            <td style="overflow-wrap: break-word;" scope="row">{{collumn.responce}}</td>
          </tr>
        
        </tbody>
      </table>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark"  >Save</button>  
  </div>
</ng-template> -->


<ng-template #showQA>
  
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">List des Questoin et Reponse</h4>
    <button type="button" class="close" aria-label="Close" (click)="closeDialog()" >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-body modal-lg">
<div>
    <h5 >Context List</h5>
        <div class="card-body table-responsive">
          <table  class="table table-striped">
              <thead>
                <tr>
                  <th scope="col"> Question </th>
                  <th scope="col"> Answer </th>
                 
                </tr>
              </thead>
              <tbody>
                <tr  *ngFor="let collumn1 of context_QRlist | paginate: {id: 'versionPagination1' , itemsPerPage: 10, currentPage: p1 }">
                  <td style="overflow-wrap: break-word;" scope="row">{{collumn1.question}}</td>
                  <td style="overflow-wrap: break-word;" scope="row">{{collumn1.responce}}</td>
                </tr>
              
              </tbody>
            </table>
            
            <div class="pagination">
              <pagination-controls id="versionPagination1" (pageChange)="p1 = $event"></pagination-controls>
            </div>
          
          </div>
          </div> 
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn btn-danger"   (click)="closeDialog()" >Close</button>
  </div>
</ng-template>